<script>
  async function callApi(path, api_key = "") {
    const url = "http://localhost" + path;
    try {
      const response = await fetch(url, {
        method: "GET",
        headers: {
          'accept': 'application/json',
          'X-API-Key': api_key
        }
      });
      if (!response.ok) {
        throw new Error(`Response status: ${response.status}`);
      }

      const json = await response.json();
      return(json);
    } catch (error) {
      console.error(error.message);
    }
  }

  function obj2tbl(obj) {
    var html = '<table>';
    for (var key in obj) {
        var value = obj[key].toString();
        html += '<tr><td>' + key + '</td><td>' + value + '</tr>';
    }
    html += '</table>';
    return html;
  }

  function arr2tbls(array) {
    html = "";
    array.forEach((obj) => html += obj2tbl(obj) + "<br>");
    return html;
  }

  function loadData() {
    callApi(document.getElementById("route").value, api_key = document.getElementById("api_key").value)
    .then((data) => {
      const my_tables = document.querySelector("div#my_tables");
      if (Array.isArray(data)) {
        my_tables.innerHTML = arr2tbls(data);
        window.data = data;
      } else {
        my_tables.innerHTML = null;
      }
    });

    callApi(document.getElementById("route").value, api_key = document.getElementById("api_key").value)
    .then((data) => {
      const response_div = document.querySelector("div#response_div");
      response_div.innerHTML = "<details><summary>JSON response:</summary>" + JSON.stringify(data) + "</details>";
    });
  }
</script>

enter API key: <input type="text" id="api_key" value="abc123" onkeydown="if(event.key === 'Enter') { loadData(); }"><br>
route: <input type="text" id="route" value="/scenarios" onkeydown="if(event.key === 'Enter') { loadData(); }"><br>
<button type="button" onclick="loadData()">submit</button>

<hr>

<div id="response_div"></div>
<br>

<div id="my_tables"></div>

<script>
  loadData();
</script>
